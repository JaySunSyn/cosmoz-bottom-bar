<!doctype html>
<html>
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
	<title>cosmoz-bottom-bar-view basic test</title>
	<script src="../../web-component-tester/browser.js"></script>
	<script src="../../webcomponentsjs/webcomponents-lite.js"></script>

	<link rel="import" href="../../paper-button/paper-button.html">
	<link rel="import" href="../cosmoz-bottom-bar-view.html">

</head>
<body>
	<test-fixture id="bottomBarViewFixture">
		<template>
			<cosmoz-bottom-bar-view style="width: 300px; height: 400px;">
				<div slot="scroller-content">
					<div>
						Lorem ipsum dolor sit amet, consectetur adipiscing elit.
						Donec tristique diam nisl, at dapibus tortor pulvinar malesuada.
						Nulla tempus congue sem, at auctor tellus.
					</div>
				</div>
				<paper-button>b</paper-button>
			</cosmoz-bottom-bar-view>
		</template>
	</test-fixture>

	<test-fixture id="scrollingBottomBarViewFixture">
		<template>
			<cosmoz-bottom-bar-view style="width: 300px; height: 300px";>
				<div slot="scroller-content">
					<div style="min-height:350px;">
						Lorem ipsum dolor sit amet, consectetur adipiscing elit.
						Donec tristique diam nisl, at dapibus tortor pulvinar malesuada.
						Nulla tempus congue sem, at auctor tellus.
					</div>
				</div>
				<paper-button>b</paper-button>
			</cosmoz-bottom-bar-view>
		</template>
	</test-fixture>

	<script>
	/*global WCT, suite, fixture, setup, test, Polymer, assert, flush */
	(function () {
		'use strict';

		suite('<cosmoz-bottom-bar-view>', function () {
			var
				bottomBarView,
				bottomBar;

			setup(function () {
				bottomBarView = fixture('bottomBarViewFixture');
				bottomBar = bottomBarView.querySelector('cosmoz-bottom-bar');
			});

			test('bottomBar is visible', function (done) {
				// Mutation observer is async, so wait before testing.
				Polymer.Base.async(function () {
					assert.equal(bottomBar.visible, true);
					done();
				}, 100);

			});
		});

		suite('scrolling bottom-bar-view', function () {
			var
				bottomBarView,
				bottomBar;

			setup(function () {
				bottomBarView = fixture('scrollingBottomBarViewFixture');
				bottomBar = bottomBarView.querySelector('cosmoz-bottom-bar');
			});

			test('bottomBar is hidden when scrolling down', function (done) {
				bottomBarView.$.scroller.scrollTop = 10;
				// Mutation observer is async, so wait before testing.
				Polymer.Base.async(function () {
					assert.equal(bottomBar.visible, false);
					done();
				}, 100);

			});

			test('bottomBar is visible when scroll is at bottom', function (done) {
				// Mutation observer is async, so wait before testing.
				Polymer.Base.async(function () {
					bottomBarView.$.scroller.scrollTop = 350;
					// Scroll management is async, so wait again
					Polymer.Base.async(function () {
						assert.equal(bottomBar.visible, true);
						done();
					}, 100);
				}, 100);

			});
		});


	}());

	</script>
</body>
</html>
